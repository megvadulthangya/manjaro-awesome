name: Simple Build Test

on:
  push:
    branches: [ main ]

jobs:
  test-build:
    runs-on: ubuntu-latest
    
    steps:
    - name: Build minimal package
      run: |
        # Create build directory
        mkdir -p /tmp/simple-build
        
        # Create minimal PKGBUILD
        cat > /tmp/simple-build/PKGBUILD << 'EOF'
pkgname=simple-test
pkgver=1.0
pkgrel=1
arch=any
package() { true; }
EOF

        # Build in Docker
        docker run --rm \
          -v /tmp/simple-build:/build \
          manjarolinux/base:latest \
          bash -c "
            pacman -Sy --noconfirm base-devel
            useradd -m builder
            su builder -c 'cd /build && makepkg'
          "

        # Show result
        echo "Build result:"
        ls -la /tmp/simple-build/ || echo "No files"